(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[705],{1239:function(e,t,r){Promise.resolve().then(r.bind(r,8267))},9906:function(e,t,r){"use strict";var o=r(9894);t.Z=void 0;var n=o(r(1402)),s=r(1674);t.Z=(0,n.default)((0,s.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment")},1043:function(e,t,r){"use strict";var o=r(9894);t.Z=void 0;var n=o(r(1402)),s=r(1674);t.Z=(0,n.default)((0,s.jsx)("path",{d:"M5 20h14v-2H5zM19 9h-4V3H9v6H5l7 7z"}),"Download")},7647:function(e,t,r){"use strict";r.d(t,{Z:function(){return g}});var o=r(9885),n=r(6723),s=r(6655),a=r(4115),i=r(3725),l=r(3997),c=r(4118),d=r(8621),u=r(132);function h(e){return(0,u.ZP)("MuiCardContent",e)}(0,d.Z)("MuiCardContent",["root"]);var x=r(1674);let Z=["className","component"],f=e=>{let{classes:t}=e;return(0,i.Z)({root:["root"]},h,t)},v=(0,l.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var g=s.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiCardContent"}),{className:s,component:i="div"}=r,l=(0,n.Z)(r,Z),d=(0,o.Z)({},r,{component:i}),u=f(d);return(0,x.jsx)(v,(0,o.Z)({as:i,className:(0,a.Z)(u.root,s),ownerState:d,ref:t},l))})},8889:function(e,t,r){"use strict";var o=r(9885),n=r(6723),s=r(6655),a=r(4115),i=r(3725),l=r(3997),c=r(4118),d=r(5147),u=r(2629),h=r(1674);let x=["className","raised"],Z=e=>{let{classes:t}=e;return(0,i.Z)({root:["root"]},u.y,t)},f=(0,l.ZP)(d.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"})),v=s.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiCard"}),{className:s,raised:i=!1}=r,l=(0,n.Z)(r,x),d=(0,o.Z)({},r,{raised:i}),u=Z(d);return(0,h.jsx)(f,(0,o.Z)({className:(0,a.Z)(u.root,s),elevation:i?8:void 0,ref:t,ownerState:d},l))});t.Z=v},2629:function(e,t,r){"use strict";r.d(t,{y:function(){return s}});var o=r(8621),n=r(132);function s(e){return(0,n.ZP)("MuiCard",e)}let a=(0,o.Z)("MuiCard",["root"]);t.Z=a},8267:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var o=r(1674),n=r(6655),s=r(2498),a=r(8623),i=r(9748),l=r(7575),c=r(5147),d=r(6561),u=r(821),h=r(10),x=r(8889),Z=r(7647),f=r(150),v=r(8349),g=r(8258),m=r(9107),j=r(5540),p=r(6267),P=r(2162),y=r(1043),S=r(9906),b=r(9081);function w(){let[e,t]=(0,n.useState)(new Date(new Date().setDate(1)).toISOString()),[r,w]=(0,n.useState)(new Date().toISOString()),{payroll:C,summary:I,isLoading:k,isError:R}=(0,b.L8)(e,r);return(0,o.jsxs)(s.Z,{children:[(0,o.jsxs)(a.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:4},children:[(0,o.jsxs)(s.Z,{children:[(0,o.jsx)(i.Z,{variant:"h4",sx:{fontWeight:800},children:"Payroll Center"}),(0,o.jsx)(i.Z,{color:"text.secondary",children:"Calculate earnings, UK tax (PAYE), and National Insurance deductions."})]}),(0,o.jsxs)(a.Z,{direction:"row",spacing:2,children:[(0,o.jsx)(l.Z,{variant:"outlined",startIcon:(0,o.jsx)(S.Z,{}),sx:{borderRadius:2},children:"Summary Report"}),(0,o.jsx)(l.Z,{variant:"contained",startIcon:(0,o.jsx)(y.Z,{}),sx:{borderRadius:2},children:"Export CSV for Bank"})]})]}),(0,o.jsx)(c.Z,{sx:{p:3,mb:4,borderRadius:4},children:(0,o.jsxs)(a.Z,{direction:"row",spacing:3,alignItems:"center",children:[(0,o.jsx)(d.Z,{label:"Start Date",type:"date",value:e.split("T")[0],onChange:e=>t(new Date(e.target.value).toISOString()),InputLabelProps:{shrink:!0}}),(0,o.jsx)(d.Z,{label:"End Date",type:"date",value:r.split("T")[0],onChange:e=>w(new Date(e.target.value).toISOString()),InputLabelProps:{shrink:!0}})]})}),R&&(0,o.jsx)(u.Z,{severity:"error",sx:{mb:3},children:"Failed to calculate payroll."}),(0,o.jsx)(h.ZP,{container:!0,spacing:3,sx:{mb:6},children:[{title:"Total Gross Pay",value:"\xa3".concat((I.totalGrossPay||0).toLocaleString()),color:"primary.main"},{title:"Total Tax (PAYE)",value:"\xa3".concat((I.totalPAYE||0).toLocaleString()),color:"error.main"},{title:"Total NI",value:"\xa3".concat((I.totalNI||0).toLocaleString()),color:"warning.main"},{title:"Net Disbursement",value:"\xa3".concat((I.totalNetPay||0).toLocaleString()),color:"success.main"}].map((e,t)=>(0,o.jsx)(h.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,o.jsx)(x.Z,{sx:{borderRadius:4,border:"1px solid",borderColor:"divider"},children:(0,o.jsxs)(Z.Z,{children:[(0,o.jsx)(i.Z,{variant:"caption",color:"text.secondary",sx:{fontWeight:700,textTransform:"uppercase"},children:e.title}),(0,o.jsx)(i.Z,{variant:"h5",sx:{fontWeight:800,mt:1,color:e.color},children:e.value})]})})},t))}),(0,o.jsxs)(c.Z,{sx:{p:0,borderRadius:4,overflow:"hidden",border:"1px solid",borderColor:"divider"},children:[(0,o.jsx)(s.Z,{sx:{p:3,bgcolor:"rgba(0,0,0,0.01)",borderBottom:"1px solid",borderColor:"divider"},children:(0,o.jsx)(i.Z,{variant:"h6",sx:{fontWeight:700},children:"Period Breakdown"})}),(0,o.jsx)(f.Z,{children:(0,o.jsxs)(v.Z,{children:[(0,o.jsx)(g.Z,{children:(0,o.jsxs)(m.Z,{children:[(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Staff Member"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Regular Hours"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Overtime"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Rate"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Gross Pay"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Tax (PAYE)"}),(0,o.jsx)(j.Z,{sx:{fontWeight:700},children:"Net Pay"})]})}),(0,o.jsx)(p.Z,{children:k?(0,o.jsx)(m.Z,{children:(0,o.jsx)(j.Z,{colSpan:7,align:"center",sx:{py:10},children:(0,o.jsx)(P.Z,{size:24})})}):C.map((e,t)=>(0,o.jsxs)(m.Z,{hover:!0,children:[(0,o.jsx)(j.Z,{sx:{fontWeight:600},children:e.workerName}),(0,o.jsxs)(j.Z,{children:[e.regularHours,"h"]}),(0,o.jsxs)(j.Z,{children:[e.overtimeHours,"h"]}),(0,o.jsxs)(j.Z,{children:["\xa3",e.hourlyRate,"/hr"]}),(0,o.jsxs)(j.Z,{sx:{fontWeight:600},children:["\xa3",e.grossPay.toFixed(2)]}),(0,o.jsxs)(j.Z,{sx:{color:"error.main"},children:["-\xa3",e.paye.toFixed(2)]}),(0,o.jsxs)(j.Z,{sx:{fontWeight:800,color:"success.main",bgcolor:"rgba(76, 175, 80, 0.04)"},children:["\xa3",e.netPay.toFixed(2)]})]},t))})]})})]})]})}},8314:function(e,t,r){"use strict";r.d(t,{h:function(){return s}});var o=r(925);let n=r(5504).env.NEXT_PUBLIC_API_URL||"http://localhost:3000/api/v1",s=o.Z.create({baseURL:n,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,async e=>{var t;let r=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401&&!r._retry){r._retry=!0;try{let e=localStorage.getItem("refreshToken");if(!e)throw Error("No refresh token");let{data:t}=await o.Z.post("".concat(n,"/auth/refresh"),{refreshToken:e});return localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("refreshToken",t.refreshToken),r.headers.Authorization="Bearer ".concat(t.accessToken),s(r)}catch(e){return localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),window.location.href="/login",Promise.reject(e)}}return Promise.reject(e)})},9081:function(e,t,r){"use strict";r.d(t,{L8:function(){return c},cs:function(){return l},dE:function(){return i},iy:function(){return a}});var o=r(2025),n=r(8314);let s=e=>n.h.get(e).then(e=>e.data),a=()=>{let{data:e,error:t,mutate:r}=(0,o.ZP)("/users",s);return{staff:(null==e?void 0:e.users)||[],isLoading:!t&&!e,isError:t,mutate:r}},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams(e).toString(),{data:r,error:n,mutate:a}=(0,o.ZP)("/shifts?".concat(t),s);return{shifts:(null==r?void 0:r.shifts)||[],isLoading:!n&&!r,isError:n,mutate:a}},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams(e).toString(),{data:r,error:n,mutate:a}=(0,o.ZP)("/timeclock/entries?".concat(t),s);return{entries:(null==r?void 0:r.entries)||[],isLoading:!n&&!r,isError:n,mutate:a}},c=(e,t)=>{let{data:r,error:s,mutate:a}=(0,o.ZP)(e&&t?["/payroll/calculate",e,t]:null,()=>n.h.post("/payroll/calculate",{startDate:e,endDate:t}).then(e=>e.data));return{payroll:(null==r?void 0:r.results)||[],summary:(null==r?void 0:r.summary)||{totalGrossPay:0,totalPAYE:0,totalNI:0,totalNetPay:0},isLoading:!s&&!r,isError:s,mutate:a}}}},function(e){e.O(0,[462,954,781,470,541,10,821,561,169,293,997,744],function(){return e(e.s=1239)}),_N_E=e.O()}]);